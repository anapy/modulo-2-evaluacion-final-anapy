"use strict";const searchButton=document.querySelector(".js-search"),serieInput=document.querySelector(".js-serie"),resultList=document.querySelector(".js-list-results"),favouriteList=document.querySelector(".js-favourite-list");let serie="",results=[],resultItems=[],favourites=[],favouriteItems=[];function clickHandler(e){e.preventDefault(),cleanResults(resultItems),serie=serieInput.value,getApiData()}function getApiData(){fetch("http://api.tvmaze.com/search/shows?q="+serie).then(e=>e.json()).then(e=>{results=e,printResults()})}function printResults(){if(0===results.length){const e=document.createElement("p");e.classList.add("error");const t=document.createTextNode("La serie buscada no estÃ¡ en nuestro listado, prueba de nuevo");e.appendChild(t),resultList.appendChild(e)}else generateHTML(resultList,results),resultItems=document.querySelectorAll(".serie-container"),createEventListener(resultItems)}function cleanResults(e){for(const t of e)resultList.removeChild(t);const t=document.querySelector(".error");null!==t&&resultList.removeChild(t)}function checkImg(e,t,s){null===e[t].show.image?s.setAttribute("src","https://via.placeholder.com/210x295/ffffff/666666/?text=TV"):s.setAttribute("src",e[t].show.image.medium)}function createEventListener(e){for(const t of e)t.addEventListener("click",handlerClickfavourite)}function handlerClickfavourite(e){let t=e.currentTarget.id;cleanFavourites(favouriteItems);const s=favourites.findIndex(e=>e.show.id===parseInt(t));-1===s?(favourites.push(results.find(e=>e.show.id===parseInt(t))),highlightFavourites(t)):(highlightFavourites(t),favourites.splice(s,1));for(let e=0;e<favourites.length;e++){const t=document.createElement("li");t.classList.add("serie-container-small"),t.setAttribute("id","fav"+favourites[e].show.id);const s=document.createElement("h2");s.classList.add("serie-title");const r=document.createTextNode(favourites[e].show.name);s.appendChild(r),t.appendChild(s);const i=document.createElement("IMG");checkImg(favourites,e,i),i.setAttribute("alt",favourites[e].show.name),i.setAttribute("height","100px"),t.appendChild(i),favouriteList.appendChild(t)}favouriteItems=document.querySelectorAll(".serie-container-small"),resultItems=document.querySelectorAll(".serie-container")}function cleanFavourites(e){for(const t of e)favouriteList.removeChild(t)}function generateHTML(e,t){for(let s=0;s<t.length;s++){const r=document.createElement("li");r.classList.add("serie-container"),r.setAttribute("id",t[s].show.id);const i=document.createElement("h2");i.classList.add("serie-title");const n=document.createTextNode(t[s].show.name);i.appendChild(n),r.appendChild(i);const o=document.createElement("IMG");checkImg(results,s,o),o.setAttribute("alt",t[s].show.name),r.appendChild(o),e.appendChild(r)}}function highlightFavourites(e){document.getElementById(""+e).classList.toggle("js-favourite")}searchButton.addEventListener("click",clickHandler);